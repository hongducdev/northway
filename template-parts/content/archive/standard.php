<?php

/**
 * @package Northway
 */

$archive_readmore_text = northway()->get_theme_opt('archive_readmore_text', esc_html__('Read More', 'northway'));
$featured_video = get_post_meta(get_the_ID(), 'featured-video-url', true);
$audio_url = get_post_meta(get_the_ID(), 'featured-audio-url', true);
?>
<article id="post-<?php the_ID(); ?>" <?php post_class('pxl-archive-post'); ?>>
    <div class="content-inner-post">

        <?php
        // Special Post Formats: Quote and Link
        if (has_post_format('quote')) {
            $quote_text = get_post_meta(get_the_ID(), 'featured-quote-text', true);
            $quote_cite = get_post_meta(get_the_ID(), 'featured-quote-cite', true);
        ?>
            <div class="format-wrap">
                <div class="quote-inner">
                    <div class="content-top">
                        <div class="qoute-icon">
                            <a href="<?php echo esc_url(get_permalink()); ?>" title="<?php the_title_attribute(); ?>">
                                <svg width="25" height="17" viewBox="0 0 25 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M5.69479 0C8.75517 0 11.1498 2.23457 11.3889 5.31319C11.7968 10.5571 8.97783 14.8369 6.43977 16.908C6.36413 16.9694 6.27011 17 6.1761 17C6.0794 17 5.98319 16.9673 5.90684 16.9025C5.68157 16.7107 5.52707 16.5637 5.18976 16.2419C4.93198 15.9957 4.56358 15.6434 3.96766 15.0846C3.8309 14.9564 3.81081 14.7541 3.92092 14.6045C5.37734 12.6217 5.41657 11.1964 5.36485 10.6727C2.3778 10.5118 0.000144144 8.18174 0 5.34086C0 2.39589 2.55449 4.55556e-05 5.69479 0Z" fill="currentColor" />
                                    <path d="M19.2663 0C22.3267 0 24.7213 2.23457 24.9604 5.31319C25.3683 10.5571 22.5493 14.8369 20.0113 16.908C19.9356 16.9694 19.8416 17 19.7476 17C19.6509 17 19.5547 16.9673 19.4784 16.9025C19.2531 16.7107 19.0986 16.5637 18.7613 16.2419C18.5035 15.9957 18.1351 15.6434 17.5392 15.0846C17.4024 14.9564 17.3823 14.7541 17.4924 14.6045C18.9489 12.6217 18.9881 11.1964 18.9364 10.6727C15.9493 10.5118 13.5717 8.18174 13.5715 5.34086C13.5715 2.39589 16.126 4.55556e-05 19.2663 0Z" fill="currentColor" />
                                </svg>
                            </a>
                        </div>
                        <div class="quote-text">
                            <a href="<?php echo esc_url(get_permalink()); ?>"><?php echo esc_html($quote_text); ?></a>
                        </div>
                    </div>
                    <?php
                    if (!empty($quote_cite)) {
                    ?>
                        <p class="quote-cite">
                            <?php echo esc_html($quote_cite); ?>
                        </p>
                    <?php
                    }
                    ?>
                    <div class="pxl-post-footer">
                        <?php northway()->blog->get_archive_meta_2(); ?>
                        <a href="<?php echo esc_url(get_permalink()); ?>" class="pxl-post-read-more">
                            <?php echo esc_html__('Read More', 'northway'); ?>
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <path d="M6.0061 0C6.20478 2.88704e-07 6.39546 0.0792145 6.53595 0.219847L11.7804 5.47001C11.9208 5.61065 12 5.80157 12 6.00044C11.9999 6.19927 11.9208 6.39026 11.7804 6.53086L6.53595 11.781C6.39548 11.9215 6.20468 12 6.0061 12C5.80751 12 5.6167 11.9216 5.47625 11.781C5.33584 11.6405 5.2576 11.4494 5.25752 11.2506C5.25752 11.0518 5.33591 10.8608 5.47625 10.7202L9.44139 6.75071L0.762527 6.74984C0.663068 6.75157 0.563851 6.73353 0.47146 6.69662C0.379202 6.65971 0.294826 6.60494 0.223965 6.53522C0.153078 6.46545 0.0968308 6.38186 0.0583878 6.29008C0.0200004 6.19836 2.84175e-05 6.09988 0 6.00044C-1.44393e-07 5.90085 0.0199212 5.80176 0.0583878 5.70992C0.09679 5.61831 0.153228 5.53533 0.223965 5.46565C0.294865 5.3959 0.379143 5.34029 0.47146 5.30338C0.56385 5.26648 0.663068 5.24843 0.762527 5.25016H9.44139L5.47625 1.2807C5.3358 1.14008 5.25754 0.949129 5.25752 0.750273C5.25752 0.551426 5.33584 0.360482 5.47625 0.219847C5.61671 0.0792343 5.80746 3.73714e-05 6.0061 0Z" fill="currentColor" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

        <?php } elseif (has_post_format('link')) {
            $link_url = get_post_meta(get_the_ID(), 'featured-link-url', true);
            $link_text = get_post_meta(get_the_ID(), 'featured-link-text', true);
        ?>
            <div class="format-wrap">
                <div class="link-inner">
                    <div class="content-top">
                        <div class="link-icon">
                            <a href="<?php echo esc_url($link_url); ?>" title="<?php the_title_attribute(); ?>">
                                <svg width="25" height="25" viewBox="0 0 25 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22.8553 2.14125C21.4809 0.770051 19.6189 0 17.6777 0C15.7365 0 13.8745 0.770051 12.5001 2.14125L11.8097 2.83161C11.719 2.92228 11.6471 3.02992 11.598 3.1484C11.5489 3.26687 11.5236 3.39385 11.5236 3.5221C11.5236 3.65034 11.5489 3.77733 11.5979 3.89581C11.647 4.01429 11.7189 4.12195 11.8096 4.21263L13.19 5.59327C13.3731 5.77636 13.6214 5.87923 13.8803 5.87925C14.1392 5.87927 14.3875 5.77645 14.5706 5.59338L15.2613 4.90282C15.9022 4.26192 16.7714 3.90189 17.6777 3.90193C18.5839 3.90196 19.4531 4.26206 20.094 4.90302C20.7348 5.54397 21.0949 6.41328 21.0949 7.31972C21.0949 8.22616 20.735 9.0955 20.0942 9.7365L16.6418 13.1884C16.037 13.7866 15.2319 14.1394 14.3821 14.1785C13.5324 14.2176 12.6983 13.9403 12.0411 13.4001L11.2919 12.7743C11.1934 12.692 11.0798 12.63 10.9574 12.5917C10.835 12.5535 10.7063 12.5397 10.5786 12.5512C10.4508 12.5626 10.3266 12.5992 10.213 12.6587C10.0994 12.7182 9.99866 12.7995 9.91649 12.898L8.66522 14.3974C8.49931 14.5962 8.41916 14.8528 8.4424 15.1108C8.46564 15.3687 8.59038 15.6069 8.78916 15.7728L9.53838 16.3982C10.9382 17.577 12.7305 18.1854 14.5585 18.1023C16.3865 18.0193 18.1163 17.2509 19.4034 15.95L22.8557 12.4981C24.2288 11.1246 25.0001 9.26181 25 7.31956C24.9999 5.37731 24.2284 3.51463 22.8553 2.14125Z" fill="currentColor" />
                                    <path d="M11.8103 19.4029C11.6272 19.2198 11.3789 19.1169 11.12 19.1169C10.8611 19.1168 10.6128 19.2197 10.4297 19.4027L9.73904 20.0933C9.09814 20.7342 8.22894 21.0942 7.32265 21.0942C6.41635 21.0942 5.54718 20.7341 4.90633 20.0931C4.26548 19.4522 3.90544 18.5828 3.90541 17.6764C3.90537 16.77 4.26534 15.9006 4.90614 15.2596L8.35848 11.8077C8.96309 11.209 9.76826 10.856 10.6181 10.8169C11.468 10.7778 12.3022 11.0554 12.9592 11.596L13.7084 12.2218C13.8069 12.3041 13.9205 12.3661 14.0429 12.4044C14.1653 12.4427 14.294 12.4565 14.4217 12.445C14.5495 12.4335 14.6737 12.3969 14.7873 12.3374C14.9009 12.2779 15.0016 12.1966 15.0838 12.0981L16.3351 10.5987C16.501 10.3999 16.5811 10.1433 16.5579 9.88532C16.5346 9.62738 16.4099 9.38925 16.2111 9.2233L15.4619 8.59793C14.0621 7.41905 12.2698 6.81058 10.4418 6.89363C8.6137 6.97669 6.88395 7.74517 5.5968 9.04613L2.14455 12.4981C0.771374 13.8715 -4.39548e-05 15.7343 1.87844e-09 17.6766C4.39586e-05 19.619 0.771546 21.4817 2.14478 22.8551C3.51802 24.2285 5.38051 25 7.32252 25C9.26452 25 11.127 24.2283 12.5002 22.8549L13.1906 22.1645C13.2813 22.0738 13.3532 21.9662 13.4023 21.8477C13.4514 21.7292 13.4767 21.6023 13.4767 21.474C13.4767 21.3458 13.4514 21.2188 13.4024 21.1003C13.3533 20.9818 13.2814 20.8742 13.1907 20.7835L11.8103 19.4029Z" fill="currentColor" />
                                </svg>
                            </a>
                        </div>
                        <div class="link-text">
                            <a href="<?php echo esc_url($link_url); ?>"><?php echo esc_html($link_text); ?></a>
                        </div>
                    </div>

                    <div class="pxl-post-footer">
                        <?php northway()->blog->get_archive_meta_2(); ?>
                        <a href="<?php echo esc_url(get_permalink()); ?>" class="pxl-post-read-more">
                            <?php echo esc_html__('Read More', 'northway'); ?>
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <path d="M6.0061 0C6.20478 2.88704e-07 6.39546 0.0792145 6.53595 0.219847L11.7804 5.47001C11.9208 5.61065 12 5.80157 12 6.00044C11.9999 6.19927 11.9208 6.39026 11.7804 6.53086L6.53595 11.781C6.39548 11.9215 6.20468 12 6.0061 12C5.80751 12 5.6167 11.9216 5.47625 11.781C5.33584 11.6405 5.2576 11.4494 5.25752 11.2506C5.25752 11.0518 5.33591 10.8608 5.47625 10.7202L9.44139 6.75071L0.762527 6.74984C0.663068 6.75157 0.563851 6.73353 0.47146 6.69662C0.379202 6.65971 0.294826 6.60494 0.223965 6.53522C0.153078 6.46545 0.0968308 6.38186 0.0583878 6.29008C0.0200004 6.19836 2.84175e-05 6.09988 0 6.00044C-1.44393e-07 5.90085 0.0199212 5.80176 0.0583878 5.70992C0.09679 5.61831 0.153228 5.53533 0.223965 5.46565C0.294865 5.3959 0.379143 5.34029 0.47146 5.30338C0.56385 5.26648 0.663068 5.24843 0.762527 5.25016H9.44139L5.47625 1.2807C5.3358 1.14008 5.25754 0.949129 5.25752 0.750273C5.25752 0.551426 5.33584 0.360482 5.47625 0.219847C5.61671 0.0792343 5.80746 3.73714e-05 6.0061 0Z" fill="currentColor" />
                            </svg>
                        </a>
                    </div>
                </div>
            </div>

        <?php } else {
        ?>
            <?php if (has_post_thumbnail()) {
                $archive_date = northway()->get_theme_opt('archive_date', true);
            ?>
                <div class="post-featured">
                    <?php
                    if (has_post_format('video')) {
                        if (has_post_thumbnail()) {
                    ?>
                            <div class="format-wrap">
                                <div class="pxl-item--image">
                                    <a href="<?php echo esc_url(get_permalink()); ?>"><?php the_post_thumbnail('full'); ?></a>
                                    <?php
                                    if (!empty($featured_video)) {
                                    ?>
                                        <div class="pxl-video-popup">
                                            <div class="content-inner">
                                                <a class="video-play-button pxl-action-popup" href="<?php echo esc_url($featured_video); ?>">
                                                    <i class="bi-play-fill"></i>
                                                </a>
                                            </div>
                                        </div>
                                    <?php
                                    } ?>
                                    <?php northway()->blog->get_archive_meta(); ?>
                                    <?php northway()->blog->get_date(); ?>
                                </div>
                            </div>
                        <?php
                        }
                    } elseif (!empty($audio_url) && has_post_format('audio')) {
                        global $wp_embed;
                        pxl_print_html($wp_embed->run_shortcode('[embed]' . $audio_url . '[/embed]'));
                    } else {
                        ?>
                        <div class="pxl-item--image">
                            <a href="<?php echo esc_url(get_permalink()); ?>"><?php the_post_thumbnail('full'); ?></a>
                            <?php northway()->blog->get_date(); ?>
                        </div>
                    <?php
                    }
                    ?>
                </div>
            <?php } ?>

            <div class="post-content">
                <h4 class="post-title">
                    <a href="<?php echo esc_url(get_permalink()); ?>" title="<?php the_title_attribute(); ?>">
                        <?php if (is_sticky()) { ?>
                            <i class="bi-check"></i>
                        <?php } ?>
                        <?php the_title(); ?>
                    </a>
                </h4>
                <div class="post-excerpt">
                    <?php
                    northway()->blog->get_excerpt(50);
                    wp_link_pages(array(
                        'before'      => '<div class="page-links">',
                        'after'       => '</div>',
                        'link_before' => '<span>',
                        'link_after'  => '</span>',
                    ));
                    ?>
                </div>
                <?php
                if (!empty($archive_readmore_text)) {
                ?>
                    <div class="pxl-post-footer">
                        <?php northway()->blog->get_archive_meta(); ?>
                        <a href="<?php echo esc_url(get_permalink()); ?>" class="pxl-post-read-more">
                            <?php echo esc_html__('Read More', 'northway'); ?>
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 12 12" fill="none">
                                <path d="M6.0061 0C6.20478 2.88704e-07 6.39546 0.0792145 6.53595 0.219847L11.7804 5.47001C11.9208 5.61065 12 5.80157 12 6.00044C11.9999 6.19927 11.9208 6.39026 11.7804 6.53086L6.53595 11.781C6.39548 11.9215 6.20468 12 6.0061 12C5.80751 12 5.6167 11.9216 5.47625 11.781C5.33584 11.6405 5.2576 11.4494 5.25752 11.2506C5.25752 11.0518 5.33591 10.8608 5.47625 10.7202L9.44139 6.75071L0.762527 6.74984C0.663068 6.75157 0.563851 6.73353 0.47146 6.69662C0.379202 6.65971 0.294826 6.60494 0.223965 6.53522C0.153078 6.46545 0.0968308 6.38186 0.0583878 6.29008C0.0200004 6.19836 2.84175e-05 6.09988 0 6.00044C-1.44393e-07 5.90085 0.0199212 5.80176 0.0583878 5.70992C0.09679 5.61831 0.153228 5.53533 0.223965 5.46565C0.294865 5.3959 0.379143 5.34029 0.47146 5.30338C0.56385 5.26648 0.663068 5.24843 0.762527 5.25016H9.44139L5.47625 1.2807C5.3358 1.14008 5.25754 0.949129 5.25752 0.750273C5.25752 0.551426 5.33584 0.360482 5.47625 0.219847C5.61671 0.0792343 5.80746 3.73714e-05 6.0061 0Z" fill="currentColor" />
                            </svg>
                        </a>
                    </div>
                <?php
                }
                ?>
            </div>

        <?php } ?>
    </div>
</article>